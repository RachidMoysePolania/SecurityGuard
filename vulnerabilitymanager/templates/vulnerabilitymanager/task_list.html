{% extends 'base_tasks.html' %}

{% block body %}

{% for task in object_list %}
<tr>
    <td><a href={% url "task_detail" slug=task.slug %}>{{task.TaskId}}</a></td>
    <td>{{task.TaskName}}</td>
    <td>{{task.TaskDescription|truncatechars:20 }}</td>
    <td>{% for user in task.UserTask.all %}{{user.username}}{% if not forloop.last %},{% endif %}{% endfor %}</td>
    <td>{% for ticket in task.TicketAssigned.all %}<a href={% url "ticket_detail" slug=ticket.slug %}>{{ticket.TicketId}}</a>{% if not forloop.last %},{% endif %}{% endfor %}</td>
    <td>{{task.TaskDueDate}}</td>
    <td>{{task.TaskState}}</td>
    <td>{% if task.TaskFiles %}Si{% else %}No{% endif %}</td>
    <td><a class="waves-effect waves-light btn-small" href={% url 'task_update' slug=task.slug %}>Editar</a></td>
    <td><a class="waves-effect waves-light btn-small" href={% url 'task_delete' slug=task.slug %}>Eliminar</a></td>
    <td>{% if task.TaskFiles %}<a class="waves-effect waves-light btn-small" href={{task.TaskFiles.url}}>Descargar archivos</a>{% else %}{% endif %}</td>
  </tr>
{% endfor %}

{% endblock body %}
{% if user.is_authenticated %}{% block user %}<a href="{% url 'logout' %}">{{ user.username | upper}}</a>{% endblock user %} {% else %}<a href="{% url 'login' %}">Log In</a>{% endif %}